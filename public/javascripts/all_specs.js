// Generated by CoffeeScript 1.3.3
(function() {
  var _this = this;

  describe("App", function() {
    beforeEach(function() {
      return _this.app = new window.Store.App({
        el: $('<div/>'),
        template: function(data) {
          return data;
        },
        catalog: {
          getProducts: function() {}
        },
        searchBox: $('<input/>')
      });
    });
    describe('.load', function() {
      return it('should load the catalog', function() {
        spyOn(_this.app.catalog, 'getProducts');
        _this.app.load();
        return expect(_this.app.catalog.getProducts).toHaveBeenCalled();
      });
    });
    describe('.render', function() {
      return it('should display the results in the view', function() {
        _this.app.render('hello world');
        return expect(_this.app.el.html()).toBe('hello world');
      });
    });
    describe('.constructor', function() {
      return it('should wire up filter catalog when search text is entered', function() {
        spyOn(_this.app, 'filterCatalog');
        _this.app.searchBox.val('gaga');
        _this.app.searchBox.keyup();
        return expect(_this.app.filterCatalog).toHaveBeenCalledWith('gaga');
      });
    });
    return describe('.filterCatalog', function() {
      return it('should render the matched products given the search text', function() {
        var apple, geek, pineapple;
        apple = new window.Store.Product({
          title: 'Apple'
        });
        pineapple = new window.Store.Product({
          title: 'Pineapple'
        });
        geek = new window.Store.Product({
          title: 'Geek',
          description: 'Coder geek'
        });
        spyOn(_this.app.catalog, 'getProducts').andReturn([apple, pineapple, geek]);
        spyOn(_this.app, 'render');
        _this.app.filterCatalog('app');
        return expect(_this.app.render).toHaveBeenCalledWith([apple, pineapple]);
      });
    });
  });

  describe('Product', function() {
    beforeEach(function() {
      return _this.product = new window.Store.Product({
        image: 'LoveJS.png',
        title: 'Google',
        description: 'The search engine!',
        price: 25
      });
    });
    return describe('.isMatch', function() {
      it('should return true when title contains the text', function() {
        var match;
        match = _this.product.isMatch('Google');
        return expect(match).toBe(true);
      });
      it('should return true when title contains the text in a different case', function() {
        var match;
        match = _this.product.isMatch('gOoGLe');
        return expect(match).toBe(true);
      });
      it('should return true when description contains the text', function() {
        var match;
        match = _this.product.isMatch('search');
        return expect(match).toBe(true);
      });
      it('should return true when description contains the text in a different case', function() {
        var match;
        match = _this.product.isMatch('the');
        return expect(match).toBe(true);
      });
      return it('should return false when neither title nor description contains the text', function() {
        var match;
        match = _this.product.isMatch('tango');
        return expect(match).toBe(false);
      });
    });
  });

}).call(this);
