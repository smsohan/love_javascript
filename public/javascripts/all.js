// Generated by CoffeeScript 1.3.3
(function() {
  var _ref;

  if ((_ref = window.Store) == null) {
    window.Store = {};
  }

  window.Store.App = (function() {

    function App(options) {
      var _this = this;
      this.el = options.el;
      this.template = options.template;
      this.catalog = options.catalog;
      this.searchBox = options.searchBox;
      this.searchBox.bind('keyup', function() {
        return _this.filterCatalog(_this.searchBox.val());
      });
    }

    App.prototype.load = function() {
      var data;
      data = this.catalog.get();
      return this.render(data);
    };

    App.prototype.render = function(data) {
      return this.el.html(this.template(data));
    };

    App.prototype.filterCatalog = function(textToSearch) {
      var matchedProducts, products,
        _this = this;
      products = this.catalog.get();
      matchedProducts = _.select(products, function(product) {
        return _this.isMatch(product, textToSearch);
      });
      return this.render(matchedProducts);
    };

    App.prototype.isMatch = function(product, textToSearch) {
      var lowerCasedTextToSearch;
      lowerCasedTextToSearch = textToSearch.toLocaleLowerCase();
      return product.title.toLocaleLowerCase().indexOf(lowerCasedTextToSearch) >= 0 || product.description.toLocaleLowerCase().indexOf(lowerCasedTextToSearch) >= 0;
    };

    return App;

  })();

  window.Store.catalog = {
    get: function() {
      return [
        {
          image: 'LoveJS.png',
          title: 'LoveJS',
          description: 'For programmers that love Javascript!',
          price: 25
        }, {
          image: 'LoveJS.png',
          title: 'Geek',
          description: 'Geeks rule the world like it or not :)',
          price: 25
        }, {
          image: 'LoveJS.png',
          title: 'LoveJS',
          description: 'For programmers that love Javascript!',
          price: 25
        }, {
          image: 'LoveJS.png',
          title: 'Geek',
          description: 'Geeks rule the world like it or not :)',
          price: 25
        }, {
          image: 'LoveJS.png',
          title: 'LoveJS',
          description: 'For programmers that love Javascript!',
          price: 25
        }, {
          image: 'LoveJS.png',
          title: 'Geek',
          description: 'Geeks rule the world like it or not :)',
          price: 25
        }
      ];
    }
  };

}).call(this);
